SELECT 
  ROUND(
    (SELECT COUNT(DISTINCT h.hostid) 
     FROM hosts h
     JOIN hosts_groups hg ON hg.hostid = h.hostid
     JOIN hstgrp grp ON grp.groupid = hg.groupid
     WHERE h.status = 0 
       AND grp.name LIKE 'Protege/Seguranca/Firewall/%')::numeric
    -
    COALESCE((SELECT COUNT(DISTINCT h.hostid)
     FROM triggers t
     JOIN functions f ON f.triggerid = t.triggerid
     JOIN items i ON i.itemid = f.itemid
     JOIN hosts h ON h.hostid = i.hostid
     JOIN hosts_groups hg ON hg.hostid = h.hostid
     JOIN hstgrp grp ON grp.groupid = hg.groupid
     WHERE t.value = 1 
       AND t.status = 0 
       AND t.priority >= 4
       AND h.status = 0 
       AND i.status = 0
       AND grp.name LIKE 'Protege/Seguranca/Firewall/%'), 0)::numeric
    * 100.0 / 
    NULLIF((SELECT COUNT(DISTINCT h.hostid) 
     FROM hosts h
     JOIN hosts_groups hg ON hg.hostid = h.hostid
     JOIN hstgrp grp ON grp.groupid = hg.groupid
     WHERE h.status = 0 
       AND grp.name LIKE 'Protege/Seguranca/Firewall/%')::numeric, 0)
  , 2) AS "Disponibilidade %";
```
**Configuração:**
- Visualização: **Gauge** ou **Stat**
- Unit: **Percent (0-100)**
- Decimals: 2
- Thresholds:
  - 0: Red
  - 95: Orange
  - 98: Yellow
  - 99: Green


└───────────────────────────────────────────────────────┘
